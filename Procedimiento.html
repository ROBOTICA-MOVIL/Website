<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Esdek Office Furniture(Digital Factory)</title>
        <link href="StylesNavBar.css" rel="stylesheet" type="text/css"> 
        <link href="Styles.css" rel="stylesheet" type="text/css">
        <script src="components/MyHeader.js" type="text/javascript" defer></script>
        <script src="components/footer.js" type="text/javascript" defer></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <div class="wrapper">
        <body class= "fondo">
            
            <header-custom></header-custom>

            <!--"Titulo de la sección"-->
            <h2>Desarrollo</h2>
            <h3> Metología </h3>
            <div> 
                <!--Texto-->
                <!--texto con estilo 'texto'-->
                <p class="texto2">
                  A continuación se muestra de manera general el paso a paso que se siguió para desarrollar este proyecto
                </p>
            </div>
           
            <div> 
                <!--Texto-->
                <!--texto con estilo 'texto'-->
                <p class="texto2" style="font-weight: bold;">Procedimiento:</p>
                <ul class="texto2">
                   <li> Indagar sobre la forma de establecer comunicación con el Lego EV3
                   <li> Reconocer conexiones y cables necesarios
                   <li> Crear y armar el laberinto 
                   <li> Posicionar y focalizar la cámara Kinect
                   <li> Identificar el origen del laberinto que reconoce la cámara
                   <li> Realizar el procesamiento de imágenes y comunicación
                   <li> Realizar pruebas
                </ul> 
                  <p class="texto2">
                    <a href="img/1.JPG?raw=true">
                    <img src="img/1.JPG?raw=true" width="50%" height="50%" alt="Red de comunicación" title="Red de comunicación" class="map">
                    </a>
                 </p>
            </div>
            <h3> Captura de información de la cámara </h3>
            <div>
             <div> 
                  <p class="texto2">
                Uso e identificación RGB de la imágen para filtrar y capturar objetos de un color especifico , para esto se desarrolla un código en Matlab que permite identificar la cámara Kinect y guardar la información que es capturada en la imágen, como el conjunto de datos corespondientes a los colores identificados y se guardan en un vector, seguido de esto se genera una imágen en escala de grises y se extraen los objetos de color azul, recordando que como se está usando la uinformación RGB que es captada, solo se pueden identificar objetos de color, rojo, verde y azul.
                </p>
                 <pre>
        <code>
            hwInfo = imaqhwinfo('kinect');
            hwInfo.DeviceInfo(1);
            hwInfo.DeviceInfo(2);
            colorVid = videoinput('kinect',1);
            depthVid = videoinput('kinect',2);
            colorvid.timeout=0.01;
            triggerconfig([colorVid depthVid],'manual');
            colorVid.FramesPerTrigger = 1;
            depthVid.FramesPerTrigger = 1;
            start([colorVid depthVid]);
            % Trigger the devices to start logging of data.
            trigger([colorVid depthVid]);
            % Retrieve the acquired data
            [colorFrameData,colorTimeData,colorMetaData] = getdata(colorVid);
            [depthFrameData,depthTimeData,depthMetaData] = getdata(depthVid);
            % Stop the devices
            %stop([colorVid depthVid]);
            % Pull out the 95th color frame
            img0=colorFrameData(:, :, :, 1);            
            img=imsubtract(img0(:,:,3),rgb2gray(img0)); 
        </code>
    </pre>
                <p class="texto2">
                Dado que las características del entorno son cambiantes como por ejemplo la iluminación del lugar el color de los objetos, es necesario aplicar un filtro para eliminar espacios en la parte interior de los objetos que reconoce así como eliminar los objetos menores a 1000 pixeles esto para evitar que se generen fantasmas por captar objetos duplicados.
                </p>
                   <pre>
        <code>
            bw=im2bw(img,0.13);                         % para binarizar la imagen
            bw=medfilt2(bw);                            % para aplicar un filtro 
            bw=imopen(bw,strel('disk',1));   
            bw=bwareaopen(bw,3000);                     %para eliminar los objetos menores a 3000 pixeles
            bw=imfill(bw, 'holes');                     % para eliminar los espacios dentro de los objetos que reconoce la camara
        </code>
    </pre>
                 <p class="texto2">
                Una vez identificados los objetos lo que nos interesa es su posición en el espacio captado por la cámara por lo que se le agregan una etiqueta a cada objeto identificado esto con el fin de contabilizar cuantos de ellos reconoce para después dibujar sobre ellos un rectangulo que los contenga e identificar el centroide, finalmente se muestra en pantalla las coordenadas que cada centroide tiene:
                </p>
                            <pre>
        <code>
                [L,N]=bwlabel(bw);                          % para agregar etiquetas a los objetos identificados, esto se guarda en la variable L, y en la variable N se guardan la cantidad de objetos idetificados
                prop=regionprops(L);                        % para obtener las propiedades de los elementos identificados
                imshow(img0);  % para mostrar las capturas
                for n=1:N
                    % las coordenadas del origen detectado por la camra corresponden a
                    % la esquina superior izquierda
                    c=round(prop(n).Centroid);             % para obtener el centroid
                    rectangle('Position', prop(n).BoundingBox,'EdgeColor','g','LineWidth',2)        % para hacer un rectangulo de color verde sobre el objeto
                    text(c(1),c(2),strcat('X:',num2str(c(1)),'Y:',num2str(c(2))),'Color','green');  % para agregar las coordenadas
                    xp(n)=c(1);
                    yp(n)=c(2);
                end
        </code>
    </pre>
                  <p class="texto2">
                    <a href="img/2.JPG?raw=true">
                    <img src="img/2.JPG?raw=true" width="50%" height="50%" alt="Origen del mapa" title="Origen del mapa" class="map">
                    </a>
                 </p>
                 <p class="texto2">
                Cabe resaltar que las coordenadas del origen detectado por la cámara corresponden a la esquina superior izquierda, por lo tanto si se quiere garantizar el mismo origen se debe dejar fija la cámara o en su defecto utilizar marcadores que indiquen la orientación y posición de la misma.
                </p>


                  </div>
            <h3> Mapa en MATLAB </h3>
                 <p class="texto2">
                Cabe resaltar que las coordenadas del origen detectado por la cámara corresponden a la esquina superior izquierda, por lo tanto si se quiere garantizar el mismo origen se debe dejar fija la cámara o en su defecto utilizar marcadores que indiquen la orientación y posición de la misma.
                </p>
            <div>
                

                  </div>
            <h3> Localización del robot </h3>
            <div>








                 
           
                <!--Texto-->
                <!--texto con estilo 'texto'-->
                <p class="texto2" style="font-weight: bold;">Simulación en NX</p>
                <ul class="texto2">
                   <li> Dimensiones: 2.5 m x 2.5 m x 2.25 m
                   <li> Cantidad de cuerpos rígidos: 4
                   <li> Cantidad de cuerpos móviles: 2
                </ul> 
                <p class="texto2">
                  En NX Mechatronics Concept Designer se implementó el movimiento de los ejes para un ciclo de operación excluyendo los procesos de setup. La intención de la simulación 
                  es verificar las dimenciones que ocupa la máquina, definir los perfiles de movimiento requeridos y determinar el tiempo de ciclo teniendo encuenta límites de aceleración y velocidad
                  impuestos por el frabricante de los actuadores lineales. Mas adelante el gemelo digital funcionará como herramienta para validar el correcto funcionamiento del las comunicaciones
                  industriales, el control implementado y el funcionamiento de la estación en conjunto con las demás que participan en la manufactura de los 3 productos.
                 </p>
                 <p class="texto2">
                    <a href="img/maquina_de_pintado.JPG?raw=true">
                    <img src="img/maquina_de_pintado.JPG?raw=true" width="50%" height="50%" alt="Estación de Pintura" title="Estación de Pintura" class="map">
                    </a>
                 </p>
                 <p class="texto3">
                    <a href="P7.html" title="Gemelo digital en NX de la estación de pintado">Gemelo digital en NX de la estación de pintado [1].</a>
                </p>
                 <style>
                 iframe {
                    display: block;
                    margin: 0 auto;
                 }
                 </style>
                 <iframe class="texto2" width="90%" height="400px" src="https://youtube.com/embed/rMVpd0NRsVc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>

            <h3> Gemelo digital para corte de tubos </h3>
            <div> 
                <!--Texto-->
                <!--texto con estilo 'texto'-->
                <p class="texto2">
                   Con esta máquina automatizada se pretende realizar el corte de tubos para ser usados en 2 de los 3 productos. Esta
                   versatilidad y la secuencia de pasos para llevar a cabo el proceso lo hace un candidato perfecto para su automatización.
                   La máquina tiene la capacidad de realizar el corte de tubos de forma automática y debe ser posible seleccionar la 
                   longitud deseada para realizar el corte, por lo que el tubo a producir podrá ser cortado dependiendo de la demanda
                   de cada una de estas partes.
                </p>
            </p>
                <p class="texto2">
                    Con el fin de realizar el gemelo digital de la máquina se proponen las siguientes operaciones las cuales deben ser
                    realizadas por la misma:
                 </p>
                </p>
                 <ol class="texto2">
                    <li> Detección de presencia de material</li>
                    <li> Sujeción del material suministrado </li>
                    <li> Desplazamiento del material dependiendo de la longitud demandada en el momento </li>
                    <li> Sujeción del material para corte</li>
                    <li> Corte del material </li>
                    <li> Almacenamiento de material</li>                    
                 </ol>
            </div>
            <!--"Titulo de la sección"-->
            <h3> Lista preliminar de materiales </h3>
            <div> 
                <p class="texto2">Tras determinar las operaciones a realizar se realiza la selección de los sensores y actuadores que tienen la capacidad de 
                    realizar dichas tareas y que adicionalmente cuentat con los elementos y compatibilidad necesaria para implementar un
                    sistema SCADA:
                </p>
            </p>
                <ol class="texto2">
                   <li> Actuador lineal electromecánico marca FESTO EPCO-25-300-3P-ST-E. </li>
                   <li> 3 Cilindros neumáticos de doble efecto marca FESTO DNC-32-50-PPV </li>
                   <li> 3 electro-válvulas 5-2 </li>
                   <li> Sensor inductivo marca WEG SL2-8C1LDA</li>
                   <li> Compresor </li>
                   <li> Unidad de manteninmiento</li>
                </ol>
            </p>
            <h3>Simulación en NX</h3>
            <div class="image-container">
                <img src="img/CorteSuperior.png" alt="CorteSuperior" class="imgdoble">
                <img src="img/CorteInferior.png" alt="CorteInferior" class="imgdoble">
            </div>
        </p>
            <p class="texto2">En NX Mechatronnics Concept Designer se simuló el movimiento de cada uno de los actuadores así como las
                físicas de cada uno de los elementos que en la realidad entrarían en contato dentro de la estación de trabajo. Al asociar
                un actuador con cada una de las operaciones mencionadas en secciones anteriores y visualizando el modelo se observa que se 
                utilizan 2 cilindores de doble efecto para realizar la sujeción de la pieza y un tercero para realizar el corte. El movimiento
                longitudinal se realiza mediante el actuado electromecánico y la presencia del material a cortar se detecta mediante el
                sensor inductivo. Con esta disposición de elementos se obtienen los siguientes resultados.
            </p>
        </p>
        <p class="texto2" style="font-weight: bold;">Tiempos de corte (260mm)</p>
            <ul class="texto2">
                <li>Setup Time: 20s</li>
                <li>Cycle Time: 4s</li>
            </ul>
        </p>
        <p class="texto2" style="font-weight: bold;">Tiempos de corte (72 y 24mm)</p>
            <ul class="texto2">
                <li>Setup Time: 20s</li>
                <li>Cycle Time: 2s</li>
            </ul>
        </p>
            <p class="texto2">
                Para los datos obtenidos es necesario recalcar que el tiempo de setup es el tiempo que tarda un operario en preparar
                la máquina cuando esta se acciona por primera vez; En ambos casos este tiempo incluye el encendido de el compresor, verificación
                del estado de la máquina y suministro de material. Posteriormente el tiempo de ciclo corresponde al tiempo que tarda la máquina
                desde que es encendida hasta que realiza un corte y vuelve a la posición inicial justo antes de tomar nuevamente el material.
            </p>
            </div>
        </p>
            <iframe width="560" height="315" class="map" src="https://www.youtube.com/embed/yewXb-4aRVw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </p>
            <iframe width="560" height="315" class="map" src="https://www.youtube.com/embed/Q6o6OXagOU0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </body>
        <p class="texto2">
            Para el correcto funcionamiento d ela estación, se conectó NX mediante OPC UA con el servidor local de Ignition el cual, mediante protocolo
            MQTT ya se encontraba conectado al servidor de Ignition en la nube y de la misma manera a las demás estaciones descritas en el proyecto.
            Para la coordinación entre la estación digital y las instrucciones ejecutadas en el PLC son necesarios ciertos TAGS de entrada y de salida
            de la estación que describen el accionamiento y verificación de las operaciones mencionadas anteriormente.
        </p>
        <footer>
            <footer-custom></footer-custom>
        </footer>
    </div>
</html>
    
